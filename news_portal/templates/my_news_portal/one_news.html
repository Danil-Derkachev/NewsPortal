{% extends 'flatpages/default.html' %}

{% load custom_tags %}
{% load custom_filters %}

{% block title %}
OneNews
{% endblock title %}

{% block content %}
<!--Содержание публикации-->
<header>
    <h3>{{one_news.title}}</h3>
</header>
<main>
    {{one_news.text|censor}}
</main>
<footer>
    Рейтинг новости {{ one_news.rating }} | Автор {{ one_news.author }} | Рейтинг автора {{ one_news.author.rating }} |
    Дата публикации {{ one_news.datetime|date:'d.m.Y' }}
</footer>
<form action="{% url 'like_post' one_news.id %}" method="post">  <!--Лайкнуть публикацию-->
    {% csrf_token %}
    <input type="hidden" name="one_news_id" value="{{ one_news.id }}">
    <input type="submit" value="Нравится">
</form>
<form action="{% url 'dislike_post' one_news.id %}" method="post">  <!--Дизлайкнуть публикацию-->
    {% csrf_token %}
    <input type="hidden" name="one_news_id" value="{{ one_news.id }}">
    <input type="submit" value="Не нравится">
</form>
<form action="{% url 'edit_news' one_news.id %}" method="get">  <!--Редактировать публикацию-->
    {% csrf_token %}
    <input type="submit" value="Редактировать">
</form>
<form action="{% url 'delete_news' one_news.id %}" method="get">  <!--Удалить публикацию-->
    {% csrf_token %}
    <input type="submit" value="Удалить">
</form>
<form action="{% url 'create_comment' %}" method="get">   <!--Создать комментарий-->
    {% csrf_token %}
    <input type="submit" value="Написать комментарий">
</form>

<!--Комментарии пользователей к этой публикации-->
<h3>Комментарии ( {{ comments|length }} )</h3>
<hr>
{% for comment in comments %}
{{ comment.user.username }} | {{ comment.datetime|date:'d.m.y' }}
<br>
{{ comment.text }}
<br>
Рейтинг комментария {{ comment.rating }}
<form action="{% url 'like_comment' %}" method="post">  <!--Лайкнуть комментарий-->
    {% csrf_token %}
    <input type="hidden" name="comment_id" value="{{ comment.id }}">
    <input type="submit" value="Нравится">
</form>
<form action="{% url 'dislike_comment' %}" method="post">   <!--Дизлайкнуть комментарий-->
    {% csrf_token %}
    <input type="hidden" name="comment_id" value="{{ comment.id }}">
    <input type="submit" value="Не нравится">
</form>
<form action="{% url 'edit_comment' comment.id %}" method="get">   <!--Редактировать комментарий-->
    {% csrf_token %}
    <input type="submit" value="Редактировать">
</form>
<form action="{% url 'delete_comment' comment.id %}" method="get">   <!--Удалить комментарий-->
    {% csrf_token %}
    <input type="hidden" name="post_id" value="{{ comment.post.id }}">
    <input type="submit" value="Удалить">
</form>
<hr>
{% empty %}
<h4>Комментариев нет</h4>
{% endfor %}
{% endblock content %}